from fastapi import FastAPI
import uvicorn
from datetime import datetime
import requests

app = FastAPI()

def check_bot_health():
    """ูุญุต ุตุญุฉ ุงูุจูุช ุงูุฃุณุงุณู"""
    try:
        response = requests.get("http://localhost:5000/health", timeout=5)
        return {"status": "healthy", "details": response.json()}
    except:
        return {"status": "unreachable", "details": "ุงูุจูุช ุบูุฑ ูุชุงุญ"}

@app.get("/report")
def get_report():
    """ุชูุฑูุฑ ุดุงูู ูุณูู ุงูููู"""
    bot_status = check_bot_health()
    
    report_date = datetime.now().strftime("%Y-%m-%d %I:%M %p")
    
    return f"""
๐ก๏ธ **ุชูุฑูุฑ ุงูุญุงุฑุณ ุงูุขูู**
โฐ {report_date}

๐ **ุญุงูุฉ ุงููุธุงู:**
- ุงูุจูุช ุงูุฃุณุงุณู: {'๐ข ูุดุท' if bot_status['status'] == 'healthy' else '๐ด ูุชููู'}
- ูุธุงู ุงููุฑุงูุจุฉ: ๐ข ุดุบุงู
- ุงูุณูุงูุฉ: ๐ข ูุธุงู ูููุตู

โ **ุงูุฃุดูุงุก ุงูุณูููุฉ:**
- ุงุชุตุงู ูุงุชุณุงุจ ุฌุงูุฒ โ
- ุงูุฎุงุฏู ูุนูู ุจุดูู ุฌูุฏ โ
- ุงููุฑุงูุจุฉ ูุดุทุฉ โ

๐ก **ูุนูููุงุช ูููุฉ:**
โข ูุฐุง ุงููุธุงู ุขูู ููุง ูุคุซุฑ ุนูู ุงูุจูุช
โข ุงููุฑุงูุจุฉ ุชุชู ูู ุฎูุงู ุงุชุตุงู ูููุตู
โข ููููู ุฅููุงู ุงููุฑุงูุจุฉ anytime

๐ง **ุงูุฅุฌุฑุงุกุงุช ุงููุชุงุญุฉ:**
1. ูุฑุงูุจุฉ ูุณุชูุฑุฉ ููุจูุช
2. ุชูุจููุงุช ูู ุญุงูุฉ ุชููู ุงูุฎุฏูุฉ
3. ุชูุงุฑูุฑ ุฏูุฑูุฉ ุนู ุงูุฃุฏุงุก

๐ฏ **ุงูุฎุทูุฉ ุงูุชุงููุฉ:**
ููููู ุงูุขู ุชุทููุฑ ุงููุธุงู ุจุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูููุฒุงุช ุงูุขููุฉ
"""

if __name__ == "__main__":
    print("๐ ุจุฏุก ุงูุญุงุฑุณ ุงูุขูู ุนูู port 8001...")
    uvicorn.run(app, host="0.0.0.0", port=8001)
